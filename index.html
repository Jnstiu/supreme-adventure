<!DOCTYPE html>
<html>
<head>
  <link rel="preconnect" href="https://server.arcgisonline.com">
    
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    
        <script>
            L_NO_TOUCH = false;
            L_DISABLE_3D = false;
        </script>
    
    <style>html, body {width: 100%;height: 100%;margin: 0;padding: 0;}
  /* Sheet header + grabber (mobile) */
  #sheetHeader { position: relative; display:flex; align-items:center; justify-content:center; padding-top: 8px; }
  #grabber { position:absolute; top: 6px; left: 50%; transform: translateX(-50%); width: 44px; height: 4px; background: #777; border-radius: 999px; opacity: .9; }
  /* Close as plain text link */
  #closeSheetBtn { position:absolute; right: 8px; left: auto; top: 4px; background: transparent; color: #e6e6e6; border: 0; padding: 6px 8px; font-size: 14px; text-decoration: underline; border-radius: 0; }
  #closeSheetBtn:hover { color: #ffffff; }
  #closeSheetBtn:focus-visible { outline: 3px solid #FFD400; outline-offset: 2px; }
</style>
    <style>#map {position:absolute;top:0;bottom:0;right:0;left:0;}
  /* Sheet header + grabber (mobile) */
  #sheetHeader { position: relative; display:flex; align-items:center; justify-content:center; padding-top: 8px; }
  #grabber { position:absolute; top: 6px; left: 50%; transform: translateX(-50%); width: 44px; height: 4px; background: #777; border-radius: 999px; opacity: .9; }
  /* Close as plain text link */
  #closeSheetBtn { position:absolute; right: 8px; left: auto; top: 4px; background: transparent; color: #e6e6e6; border: 0; padding: 6px 8px; font-size: 14px; text-decoration: underline; border-radius: 0; }
  #closeSheetBtn:hover { color: #ffffff; }
  #closeSheetBtn:focus-visible { outline: 3px solid #FFD400; outline-offset: 2px; }
</style>
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.6.0/dist/leaflet.js"></script>
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.6.0/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css"/>
    
            <meta name="viewport" content="width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
            <style>
                #map_c8689fa0fa819fbcc2c9e3f97e0c1fbb {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
            
  /* Sheet header + grabber (mobile) */
  #sheetHeader { position: relative; display:flex; align-items:center; justify-content:center; padding-top: 8px; }
  #grabber { position:absolute; top: 6px; left: 50%; transform: translateX(-50%); width: 44px; height: 4px; background: #777; border-radius: 999px; opacity: .9; }
  /* Close as plain text link */
  #closeSheetBtn { position:absolute; right: 8px; left: auto; top: 4px; background: transparent; color: #e6e6e6; border: 0; padding: 6px 8px; font-size: 14px; text-decoration: underline; border-radius: 0; }
  #closeSheetBtn:hover { color: #ffffff; }
  #closeSheetBtn:focus-visible { outline: 3px solid #FFD400; outline-offset: 2px; }
</style>
        
<style>
/* --- Mobile help-panel refinements (override) --- */
@media (max-width: 900px), (pointer: coarse) {
  /* Collapsed: show only the circular icon, no bar */
  #helpPanel.collapsed {
    background: transparent;
    border: none;
    box-shadow: none;
    width: auto;
    max-width: none;
    padding: 0;
    pointer-events: none; /* avoid covering UI beneath */
  }
  #helpPanel.collapsed .hp-header { padding: 0; }
  #helpPanel.collapsed #helpToggle {
    pointer-events: auto; /* clickable */
    padding: 8px;
    border-radius: 999px;
    min-width: 36px;
    min-height: 36px;
  }
  /* Keep only the icon; hide the Show/Hide label when collapsed */
  #helpPanel.collapsed #helpToggle::before { content: "ⓘ"; font-size: 14px; font-weight: 800; }
  #helpPanel.collapsed #helpToggle::after { content: ""; }

  /* Expanded: move the icon to the right edge */
  #helpPanel:not(.collapsed) .hp-header {
    justify-content: flex-end;
  }
  /* On mobile, we keep the title hidden to save space */
  #helpPanel .hp-header h3 { display: none; }
}
</style>
<style>
/* === Mobile-only tweaks: X buttons for Help + City sheet; title on the left === */
@media (max-width: 900px), (pointer: coarse) {
  /* Help panel: expanded header shows title left and X on right */
  #helpPanel:not(.collapsed) .hp-header {
    justify-content: space-between;
  }
  #helpPanel:not(.collapsed) .hp-header h3 {
    display: block;
  }
  #helpPanel:not(.collapsed) #helpToggle {
    background: transparent;
    border: 0;
    padding: 8px;
    min-width: 36px;
    min-height: 36px;
    border-radius: 999px;
    font-size: 0; /* hide any inline text; use pseudo-element */
  }
  #helpPanel:not(.collapsed) #helpToggle::before { content: ""; } /* ensure icon from collapsed isn't kept */
  #helpPanel:not(.collapsed) #helpToggle::after {
    content: "✕";
    font-size: 16px;
    font-weight: 800;
    line-height: 1;
  }

  /* City sheet: replace "Close" text with an X, keep accessible label */
  #closeSheetBtn {
    font-size: 0; /* hide text */
    padding: 8px;
    min-width: 36px;
    min-height: 36px;
    border-radius: 999px;
    text-decoration: none; /* remove underline for icon */
  }
  #closeSheetBtn::after {
    content: "✕";
    font-size: 16px;
    font-weight: 800;
    line-height: 1;
  }
}
</style>
<style>
/* Mobile-only: show ✕ instead of 'Close' text in sheet & instructions */
@media (max-width: 900px), (pointer: coarse) {
  /* Cities bottom sheet close button */
  #closeSheetBtn {
    font-size: 0 !important;
    text-decoration: none !important;
    color: #fff !important;
  }
  #closeSheetBtn::after {
    content: "✕";
    font-size: 16px;
    font-weight: 700;
    line-height: 1;
  }

  /* Instructions panel close button (expanded state) */
  #helpPanel:not(.collapsed) #helpToggle {
    font-size: 0 !important;
    text-decoration: none !important;
    color: #fff !important;
    background: transparent !important;
    border: 0 !important;
    padding: 0 8px !important;
    min-width: 36px; min-height: 36px;
    border-radius: 999px;
  }
  #helpPanel:not(.collapsed) #helpToggle::after {
    content: "✕";
    font-size: 16px;
    font-weight: 700;
    line-height: 1;
  }
}
</style>
<style>
/* FINAL override: mobile help toggle shows an X when expanded (white), icon-only when collapsed */
@media (max-width: 900px), (pointer: coarse) {
  #helpPanel:not(.collapsed) #helpToggle {
    color: #fff !important;
    background: transparent !important;
    border: 0 !important;
    padding: 8px !important;
    min-width: 36px; min-height: 36px;
  }
  #helpPanel:not(.collapsed) #helpToggle::before { content: "" !important; }
  #helpPanel:not(.collapsed) #helpToggle::after { content: "✕" !important; font-size: 18px; font-weight: 800; line-height: 1; }
}
</style>

<style>
/* Desktop: prevent pseudo-content from duplicating labels on help toggle */
@media (min-width: 901px), (pointer: fine) {
  #helpPanel #helpToggle::before,
  #helpPanel #helpToggle::after { content: "" !important; }
}
</style>

<style>
/* Mobile intro scrim to require dismissing instructions before map interaction */
@media (max-width: 900px), (pointer: coarse) {
  #introScrim {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.35);
    display: none; /* shown by JS on first load */
    pointer-events: auto;
    /* Place under the help panel but above the map and other UI */
    z-index: 815;
  }
  /* Ensure help panel sits above scrim when visible */
  #helpPanel { z-index: 820; }
}
</style>
<style>
/* Mobile-only scrim for must-dismiss help panel */
@media (max-width: 900px), (pointer: coarse) {
  #helpScrim {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.35);
    z-index: 795; /* below helpPanel (800), above map */
    display: none;
  }
  #helpScrim.visible { display: block; }
}
</style>
</head>
<body>
    
    
<style>
  .leaflet-popup-content { max-height: min(60vh, 520px); overflow-y: auto; padding-right: 6px; }
  .leaflet-popup-content::-webkit-scrollbar { width: 8px; }
  .leaflet-popup-content::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.35); border-radius: 8px; }
  @media (max-width: 768px) {
    .leaflet-popup-content-wrapper, .leaflet-popup-tip { max-width: min(88vw, 340px) !important; }
    .leaflet-popup-content { max-width: calc(min(88vw, 340px) - 24px); font-size: 15px; }
  }

  .cr-airport { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; font-size: 16px; line-height: 1.5; color: #111; }
  .cr-airport ul { margin: 6px 0 0 18px; padding: 0; }

  #cityMenu { position: absolute; top: 12px; right: 12px; z-index: 1000; background: rgba(17,17,17,0.9); color: #fff; padding: 10px; border-radius: 12px; backdrop-filter: blur(2px); font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; }
  #cityMenu h3 { margin: 0 0 8px; font-size: 14px; font-weight: 700; letter-spacing: .3px; }
  #cityMenu .btn { display: block; width: 100%; text-align: left; background: #222; color: #fff; border: 2px solid #444; border-radius: 10px; padding: 10px 12px; margin: 6px 0; font-size: 14px; cursor: pointer; min-height: 44px; font-family: inherit; }
  #cityMenu .btn:hover { background: #2c2c2c; }
  #cityMenu .btn:focus-visible { outline: 3px solid #FFD400; outline-offset: 2px; }
  #cityMenu .btn.selected { background: #314252; border-color: #4e6d8a; }
  @media (max-width: 900px), (pointer: coarse) { #cityMenu { display: none; } }

  #cityFab { position: absolute; right: 14px; bottom: calc(16px + env(safe-area-inset-bottom)); z-index: 1000; background: #111; color: #fff; border: 0; border-radius: 9999px; width: 56px; height: 56px; box-shadow: 0 10px 20px rgba(0,0,0,.35); font-weight: 700; display: none; }
  #cityFab:focus-visible { outline: 3px solid #FFD400; outline-offset: 2px; }
  @media (min-width: 901px) and (pointer: fine) { #cityFab { display: none; } }

  #citySheet { position: absolute; left: 0; right: 0; bottom: 0; transform: translateY(100%); transition: transform .28s ease; z-index: 1000; background: rgba(20,20,20,.97); color: #fff; border-top-left-radius: 16px; border-top-right-radius: 16px; padding: 8px 14px calc(14px + env(safe-area-inset-bottom)); box-shadow: 0 -12px 28px rgba(0,0,0,.4); display: block; }
  #citySheet.open { transform: translateY(0%); }
  #citySheet h3 { margin: 6px 0 8px; font-size: 16px; font-weight: 800; }
  #citySheet .btn { display: block; width: 100%; text-align: left; background: #222; color: #fff; border: 2px solid #444; border-radius: 12px; padding: 12px 14px; margin: 8px 0; font-size: 16px; min-height: 48px; }
  @media (min-width: 901px) and (pointer: fine) { #citySheet { display: none; } }

  /* Sheet header + grabber (mobile) */
  #sheetHeader { position: relative; display:flex; align-items:center; justify-content:center; padding-top: 8px; }
  #grabber { position:absolute; top: 6px; left: 50%; transform: translateX(-50%); width: 44px; height: 4px; background: #777; border-radius: 999px; opacity: .9; }
  /* Close as plain text link */
  #closeSheetBtn { position:absolute; right: 8px; left: auto; top: 4px; background: transparent; color: #e6e6e6; border: 0; padding: 6px 8px; font-size: 14px; text-decoration: underline; border-radius: 0; }
  #closeSheetBtn:hover { color: #ffffff; }
  #closeSheetBtn:focus-visible { outline: 3px solid #FFD400; outline-offset: 2px; }


#cityMenu #resetViewBtn { 
  display:block; width:100%; text-align:left; 
  margin: 6px 0 8px; padding: 10px 12px; 
  background:#222; color:#fff; border:1px solid #333; border-radius:10px; 
  cursor:pointer; font-size:14px; line-height:1.2; min-height:44px; 
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
}
#cityMenu #resetViewBtn:hover { background:#2c2c2c; }
#cityMenu #resetViewBtn:focus-visible { outline:3px solid #FFD400; outline-offset: 2px; }



/* Help / Instructions panel (bottom-left) */
#helpPanel {
  position: absolute;
  left: 12px;
  bottom: calc(12px + env(safe-area-inset-bottom));
  z-index: 800;
  width: min(92vw, 340px);
  max-width: 340px;
  background: rgba(20,20,20,0.92);
  color: #fff;
  border: 1px solid #333;
  border-radius: 12px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.35);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  backdrop-filter: saturate(110%) blur(2px);
}
#helpPanel .hp-header {
  display: flex; align-items: center; justify-content: space-between;
  gap: 8px; padding: 10px 12px 6px;
}
#helpPanel .hp-header h3 {
  margin: 0; font-size: 14px; font-weight: 700; letter-spacing: .3px;
}
#helpToggle {
  margin: 0; padding: 8px 10px; min-height: 36px;
  background: #222; color: #fff; border: 1px solid #333; border-radius: 10px;
  cursor: pointer; font-size: 13px; line-height: 1.1;
}
#helpToggle:hover { background: #2c2c2c; }
#helpToggle:focus-visible { outline: 3px solid #FFD400; outline-offset: 2px; }

#helpBody {
  padding: 0 12px 12px;
  font-size: 13px; line-height: 1.5;
}
#helpBody p { margin: 6px 0; }
#helpBody ul { margin: 6px 0 0 18px; padding: 0; }
#helpBody li { margin: 4px 0; }
#helpBody .hint { opacity: .9; }

/* Collapsed state */
#helpPanel.collapsed #helpBody { display: none; }
#helpPanel.collapsed #helpToggle::after { content: "Show"; }
#helpPanel:not(.collapsed) #helpToggle::after { content: "Hide"; }

/* Mobile tweaks */
@media (max-width: 900px), (pointer: coarse) {
  #helpPanel { width: min(92vw, 320px); font-size: 13px; }
}



/* Mobile tweaks: icon-only help header, left aligned; floating reset button */
@media (max-width: 900px), (pointer: coarse) {
  #helpPanel .hp-header { justify-content: flex-start; }
  #helpPanel .hp-header h3 { display: none; }
  #helpToggle { padding: 8px; border-radius: 999px; min-width: 36px; min-height: 36px; }
  #helpToggle::before { content: "ⓘ"; font-size: 14px; font-weight: 800; }
  /* Hide the Show/Hide text label to reduce space on mobile */
  #helpPanel.collapsed #helpToggle::after,
  #helpPanel:not(.collapsed) #helpToggle::after { content: ""; }
}

/* Mobile reset-to-default floating button */
#mobileResetBtn {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  bottom: calc(84px + env(safe-area-inset-bottom));
  z-index: 810;
  display: none;
  background: #222;
  color: #fff;
  border: 1px solid #333;
  border-radius: 999px;
  padding: 10px 14px;
  font-size: 16px;
  line-height: 1;
  box-shadow: 0 6px 18px rgba(0,0,0,.35);
  cursor: pointer;
}
#mobileResetBtn.show { display: inline-flex; align-items: center; justify-content: center; }
#mobileResetBtn:focus-visible { outline: 3px solid #FFD400; outline-offset: 2px; }
/* Icon look – "expand to full" diagonals */
#mobileResetBtn::before { content: "⤢"; font-size: 18px; font-weight: 700; }


/* Safety: prevent closed sheet from blocking map gestures */
#citySheet { pointer-events: none; }
#citySheet.open { pointer-events: auto; }

</style>

<div id="cityMenu" role="navigation" aria-label="City quick jump">
  <h3 id="cityMenuHeading">Quick jump</h3>
  <button id="resetViewBtn" type="button" aria-controls="map_c8689fa0fa819fbcc2c9e3f97e0c1fbb" aria-label="Reset to all cities view">Reset view</button>
  <button class="btn" aria-labelledby="cityMenuHeading" aria-controls="map_c8689fa0fa819fbcc2c9e3f97e0c1fbb" aria-pressed="false" data-city="San José" data-lat="9.93" data-lng="-84.08">San José</button>
  <button class="btn" aria-labelledby="cityMenuHeading" aria-controls="map_c8689fa0fa819fbcc2c9e3f97e0c1fbb" aria-pressed="false" data-city="Tamarindo" data-lat="10.3" data-lng="-85.84">Tamarindo</button>
  <button class="btn" aria-labelledby="cityMenuHeading" aria-controls="map_c8689fa0fa819fbcc2c9e3f97e0c1fbb" aria-pressed="false" data-city="Jacó" data-lat="9.62" data-lng="-84.63">Jacó</button>
  <button class="btn" aria-labelledby="cityMenuHeading" aria-controls="map_c8689fa0fa819fbcc2c9e3f97e0c1fbb" aria-pressed="false" data-city="Manuel Antonio" data-lat="9.39" data-lng="-84.14">Manuel Antonio</button>
  <button class="btn" aria-labelledby="cityMenuHeading" aria-controls="map_c8689fa0fa819fbcc2c9e3f97e0c1fbb" aria-pressed="false" data-city="Puerto Viejo" data-lat="9.66" data-lng="-82.76">Puerto Viejo</button>
</div>

<button id="cityFab" aria-haspopup="dialog" aria-expanded="false" aria-controls="citySheet">Cities</button>
<div id="citySheet" role="dialog" aria-modal="true" aria-labelledby="sheetTitle">
  <div id="sheetHeader">
    <div id="grabber" aria-hidden="true"></div>
    <button id="closeSheetBtn" aria-label="Close quick jump">Close</button>
  </div>
  <h3 id="sheetTitle">Quick jump</h3>
  <button class="btn" data-city="San José" data-lat="9.93" data-lng="-84.08">San José</button>
  <button class="btn" data-city="Tamarindo" data-lat="10.3" data-lng="-85.84">Tamarindo</button>
  <button class="btn" data-city="Jacó" data-lat="9.62" data-lng="-84.63">Jacó</button>
  <button class="btn" data-city="Manuel Antonio" data-lat="9.39" data-lng="-84.14">Manuel Antonio</button>
  <button class="btn" data-city="Puerto Viejo" data-lat="9.66" data-lng="-82.76">Puerto Viejo</button>
</div>

<script>
  window.addEventListener('load', function() {
    var PADDING_PX = 300;

    var hardSW = L.latLng(7.0, -87.0);
    var hardNE = L.latLng(12.1, -82.0);
    var hardBounds = L.latLngBounds(hardSW, hardNE);

    var softSW = L.latLng(7.0 - 0.60, -87.0 - 0.35);
    var softNE = L.latLng(12.1 + 0.60, -82.0 + 0.35);
    var softBounds = L.latLngBounds(softSW, softNE);

    var mapRef = map_c8689fa0fa819fbcc2c9e3f97e0c1fbb;
    function isMobile() { return window.matchMedia('(max-width: 900px), (pointer: coarse)').matches; }

    var cityBounds = L.latLngBounds([[9.93,-84.08],[10.3,-85.84],[9.62,-84.63],[9.39,-84.14],[9.66,-82.76]]);

    function fitAll() {
      if (isMobile()) {
        var baseZoom = mapRef.getBoundsZoom(cityBounds, true);
        var center = cityBounds.getCenter();
        mapRef.setView(center, baseZoom, {animate:false});
        var candidate = baseZoom + 1;
        mapRef.setView(center, candidate, {animate:false});
        if (!mapRef.getBounds().contains(cityBounds)) mapRef.setView(center, baseZoom, {animate:false});
        mapRef.panInsideBounds(cityBounds.pad(0.02), {animate:false});
      } else {
        mapRef.fitBounds(cityBounds, { paddingTopLeft: [30, 40], paddingBottomRight: [200, 30], animate: false });
      }
    }
    fitAll();

    var initialCenter = mapRef.getCenter();
    var initialZoom = mapRef.getZoom();

    function resetToInitial(smooth) {
      if (mapRef.flyTo && smooth) mapRef.flyTo(initialCenter, initialZoom, {duration:.8});
      else mapRef.setView(initialCenter, initialZoom, {animate:!!smooth});
    }

    function padBoundsByPixels(bounds, px) {
      var z = mapRef.getZoom();
      var nw = mapRef.project(bounds.getNorthWest(), z);
      var se = mapRef.project(bounds.getSouthEast(), z);
      var pad = L.point(px, px);
      var nw2 = nw.subtract(pad);
      var se2 = se.add(pad);
      return L.latLngBounds(mapRef.unproject(nw2, z), mapRef.unproject(se2, z));
    }
    function applyMaxBounds() {
      if (isMobile()) mapRef.setMaxBounds(padBoundsByPixels(L.latLngBounds([7.0,-87.0], [12.1,-82.0]), PADDING_PX));
      else mapRef.setMaxBounds(L.latLngBounds([7.0,-87.0], [12.1,-82.0]));
    }
    applyMaxBounds();

    // ROUTING
    let activeRouteLayer = null;
    async function drawRoute(origin, dest) {
      try {
        const url = `https://router.project-osrm.org/route/v1/driving/${origin.lng},${origin.lat};${dest.lng},${dest.lat}?overview=full&geometries=geojson`;
        const res = await fetch(url);
        const data = await res.json();
        const geo = data.routes[0].geometry;
        if (activeRouteLayer) mapRef.removeLayer(activeRouteLayer);
        activeRouteLayer = L.geoJSON(geo, {style: { color: '#00D8D8', weight: 5, opacity: 0.9 } }).addTo(mapRef);
        mapRef.fitBounds(activeRouteLayer.getBounds(), { padding: [30,30] });
      } catch(e) {
        const g = (o,d) => `https://www.google.com/maps/dir/?api=1&origin=${o.lat},${o.lng}&destination=${d.lat},${d.lng}&travelmode=driving`;
        window.open(g(origin, dest), '_blank', 'noopener');
      }
    }
    const airports = {"SJO": {"lat": 9.9939, "lng": -84.2088}, "LIR": {"lat": 10.5933, "lng": -85.5444}, "XQP": {"lat": 9.4432, "lng": -84.1298}, "TNO": {"lat": 10.3139, "lng": -85.8163}};
    const cities = {"San Jos\u00e9": {"lat": 9.93, "lng": -84.08}, "Tamarindo": {"lat": 10.3, "lng": -85.84}, "Jac\u00f3": {"lat": 9.62, "lng": -84.63}, "Manuel Antonio": {"lat": 9.39, "lng": -84.14}, "Puerto Viejo": {"lat": 9.66, "lng": -82.76}};

    window.routeCityToAirport = (city, code) => drawRoute(cities[city], airports[code]);
    window.routeAirportToCity = (code, city) => drawRoute(airports[code], cities[city]);

    // POPUP CONFIG (pan/zoom limits while open)
    function enableLimitedZoom() {
      var z = mapRef.getZoom();
      mapRef._savedMinZoom = mapRef.getMinZoom();
      mapRef._popupMinZoom = Math.max(mapRef.getBoundsZoom(L.latLngBounds([7.0,-87.0], [12.1,-82.0])), z - 2);
      mapRef.setMinZoom(mapRef._popupMinZoom);
    }
    function restoreZoomLimits() {
      if (mapRef._savedMinZoom !== undefined) { mapRef.setMinZoom(mapRef._savedMinZoom); delete mapRef._savedMinZoom; }
      delete mapRef._popupMinZoom;
    }
    mapRef.on('popupopen', function() { if (isMobile()) enableLimitedZoom(); });
    mapRef.on('popupclose', function() { if (isMobile()) restoreZoomLimits(); });

    // QUICK JUMP (desktop)
    let selectedCity = null;
    function setSelected(btn, on) { btn.classList.toggle('selected', on); btn.setAttribute('aria-pressed', on ? 'true' : 'false'); }
    document.querySelectorAll('#cityMenu .btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const city = btn.dataset.city;
        const lat = parseFloat(btn.dataset.lat);
        const lng = parseFloat(btn.dataset.lng);
        if (selectedCity === city) {
          setSelected(btn, false); selectedCity = null;
          Object.values({"San José": marker_32f83795174731e53923e2d93bfcdab4, "Tamarindo": marker_0f2068c66c3e5ffe5c6bb909e537574c, "Jacó": marker_ffbb1e099febdb6fea9ac2ab69a36ce3, "Manuel Antonio": marker_6b06df13e29ebaf0c0a815a3171e0dc8, "Puerto Viejo": marker_bd8bcf8966901722f25a3c28351c816a}).forEach(mk=> mk.closePopup && mk.closePopup());
          if (activeRouteLayer) { mapRef.removeLayer(activeRouteLayer); activeRouteLayer=null; }
          setTimeout(()=> resetToInitial(true), 120);
        } else {
          document.querySelectorAll('#cityMenu .btn').forEach(b=> setSelected(b, false));
          setSelected(btn, true); selectedCity = city;
          if (mapRef.flyTo) mapRef.flyTo([lat,lng], Math.max(mapRef.getZoom(), 11), {duration:.7}); else mapRef.setView([lat,lng], Math.max(mapRef.getZoom(), 11));
          const mk = {"San José": marker_32f83795174731e53923e2d93bfcdab4, "Tamarindo": marker_0f2068c66c3e5ffe5c6bb909e537574c, "Jacó": marker_ffbb1e099febdb6fea9ac2ab69a36ce3, "Manuel Antonio": marker_6b06df13e29ebaf0c0a815a3171e0dc8, "Puerto Viejo": marker_bd8bcf8966901722f25a3c28351c816a}[city];
          setTimeout(()=> mk && mk.openPopup && mk.openPopup(), 720);
        }
      });
    });

    
    // Desktop reset button
    var resetBtn = document.getElementById('resetViewBtn');
    if (resetBtn) {
      resetBtn.addEventListener('click', () => {
        document.querySelectorAll('#cityMenu .btn').forEach(b=> {
          b.classList.remove('selected'); b.setAttribute('aria-pressed','false');
        });
        selectedCity = null;
        try { Object.values({"San José": marker_32f83795174731e53923e2d93bfcdab4, "Tamarindo": marker_0f2068c66c3e5ffe5c6bb909e537574c, "Jacó": marker_ffbb1e099febdb6fea9ac2ab69a36ce3, "Manuel Antonio": marker_6b06df13e29ebaf0c0a815a3171e0dc8, "Puerto Viejo": marker_bd8bcf8966901722f25a3c28351c816a}).forEach(mk=> mk.closePopup && mk.closePopup()); } catch(e) { }
        if (typeof activeRouteLayer !== 'undefined' && activeRouteLayer) { 
          mapRef.removeLayer(activeRouteLayer); activeRouteLayer = null; 
        }
        setTimeout(()=> resetToInitial(true), 60);
      });
    }
    // Help panel toggle (with mobile scrim; only close via ✕ or outside tap)
    (function(){
      var panel = document.getElementById('helpPanel');
      var btn = document.getElementById('helpToggle');
      var scrim = document.getElementById('helpScrim');
      if (!panel || !btn) return;

      function isMobile(){ 
        try { return window.matchMedia('(pointer: coarse)').matches || window.innerWidth <= 900; } 
        catch(e){ return window.innerWidth <= 900; } 
      }

      function setExpanded(expanded){
        btn.setAttribute('aria-expanded', expanded ? 'true' : 'false');
        panel.classList.toggle('collapsed', !expanded);
        // Desktop uses text; mobile uses icon CSS
        if (!isMobile()) {
          btn.textContent = expanded ? 'Hide' : 'Show';
        } else {
          btn.textContent = '';
        }
        if (scrim) {
          if (isMobile() && expanded) scrim.classList.add('visible');
          else scrim.classList.remove('visible');
        }
      }

      // Start expanded; on mobile show scrim until dismissed
      setExpanded(true);

      btn.addEventListener('click', function(e){
        var open = btn.getAttribute('aria-expanded') === 'true';
        if (open) {
          // collapse -> hide scrim
          setExpanded(false);
        } else {
          setExpanded(true);
        }
      });

      if (scrim) {
        scrim.addEventListener('click', function(){
          // Outside click closes it (mobile only)
          if (!isMobile()) return;
          setExpanded(false);
        });
      }

      // Keep labels consistent when resizing across breakpoints
      window.addEventListener('resize', function(){
        var isOpen = btn.getAttribute('aria-expanded') === 'true';
        setExpanded(isOpen);
      });
    })();
// Mobile: floating "Reset view" button (appears when zoomed-in on a selected city)
    (function() {
      var btn = document.getElementById('mobileResetBtn');
      if (!btn) return;

      function approxEqual(a, b, tol) { return Math.abs(a - b) <= tol; }
      function isAtInitialView() { 
        try { 
          return approxEqual(mapRef.getZoom(), (window.initialZoom||mapRef.getZoom()), 0.05);
        } catch(e) { return false; }
      }
      function updateMobileResetVisibility() {
        try {
          if (!isMobile()) { btn.classList.remove('show'); return; }
          var hasCity = (typeof selectedCity !== 'undefined' && selectedCity);
          var zoomedIn = mapRef && mapRef.getZoom && mapRef.getZoom() > ((window.initialZoom||mapRef.getZoom()) + 0.01);
          if (hasCity && zoomedIn) btn.classList.add('show'); else btn.classList.remove('show');
        } catch(e) { /* no-op */ }
      }

      // Trigger visibility on relevant map changes
      try {
        mapRef.on('moveend zoomend', updateMobileResetVisibility);
      } catch(e) { /* mapRef not ready yet */ }

      // Delegate clicks on the mobile city sheet buttons to update visibility after flyTo
      var sheet = document.getElementById('citySheet');
      if (sheet) {
        sheet.addEventListener('click', function(ev) {
          var b = ev.target.closest && ev.target.closest('button.btn');
          if (!b) return;
          setTimeout(updateMobileResetVisibility, 900);
          setTimeout(crEnableMapInteraction, 1000);
        });
      }

      // Also check when desktop quick-jump is used on mobile
      var desktopList = document.getElementById('cityMenu');
      if (desktopList) {
        desktopList.addEventListener('click', function(ev) {
          if (!isMobile()) return;
          var b = ev.target.closest && ev.target.closest('button.btn');
          if (!b) return;
          setTimeout(updateMobileResetVisibility, 900);
          setTimeout(crEnableMapInteraction, 1000);
        });
      }

      // Reset behavior
      btn.addEventListener('click', function() {
        try { Object.values({"San José": marker_32f83795174731e53923e2d93bfcdab4, "Tamarindo": marker_0f2068c66c3e5ffe5c6bb909e537574c, "Jacó": marker_ffbb1e099febdb6fea9ac2ab69a36ce3, "Manuel Antonio": marker_6b06df13e29ebaf0c0a815a3171e0dc8, "Puerto Viejo": marker_bd8bcf8966901722f25a3c28351c816a}).forEach(mk=> mk.closePopup && mk.closePopup()); } catch(e) {}
        if (typeof activeRouteLayer !== 'undefined' && activeRouteLayer) { 
          mapRef.removeLayer(activeRouteLayer); activeRouteLayer = null; 
        }
        if (typeof selectedCity !== 'undefined') selectedCity = null;
        // Close mobile sheet if open by clicking its Close control if present
        var closeBtn = document.getElementById('closeSheetBtn');
        if (closeBtn && isMobile()) try { closeBtn.click(); } catch(e) { }
        // Gentle pan back to initial
        try { resetToInitial(true); } catch(e) { }
        btn.classList.remove('show');
      });

      // Initial state
      setTimeout(updateMobileResetVisibility, 600);
    })();

    
    // Intro scrim: show instructions first on mobile, require dismissal
    (function(){
      var panel = document.getElementById('helpPanel');
      var btn = document.getElementById('helpToggle');
      var scrim = document.getElementById('introScrim');
      if (!panel || !btn || !scrim) return;

      function isMobile(){ try { return window.matchMedia('(pointer: coarse)').matches || window.innerWidth <= 900; } catch(e){ return false; } }
      function syncScrim(){
        if (!isMobile()) { scrim.style.display = 'none'; return; }
        // Show when instructions are expanded; hide when collapsed
        if (panel.classList.contains('collapsed')) { scrim.style.display = 'none'; }
        else { scrim.style.display = 'block'; }
      }

      // When user clicks the button, update scrim after state flips
      btn.addEventListener('click', function(){ setTimeout(syncScrim, 50); });

      // Tapping outside (on scrim) closes instructions
      scrim.addEventListener('click', function(){
        // If currently expanded, simulate a click on the toggle to collapse
        if (!panel.classList.contains('collapsed')) { try { btn.click(); } catch(e){} }
      });

      // On first load on mobile, ensure instructions are expanded and scrim is shown
      if (isMobile()) {
        try {
          btn.setAttribute('aria-expanded','true');
          panel.classList.remove('collapsed');
        } catch(e){}
        syncScrim();
      }
    })();

    // === Desktop/General: clear route on city switch + sync Quick jump highlight ===
    (function(){
      // Small helper to clear active route layer if present
      function clearActiveRoute() {
        try {
          if (typeof activeRouteLayer !== 'undefined' && activeRouteLayer) {
            mapRef.removeLayer(activeRouteLayer);
            activeRouteLayer = null;
          }
        } catch(e) {}
      }
      // Sync the right-panel Quick jump highlight
      function syncQuickJumpHighlight(cityName) {
        var btns = document.querySelectorAll('#cityMenu .btn');
        btns.forEach(function(b){
          var isMatch = cityName && b.getAttribute('data-city') === cityName;
          b.classList.toggle('selected', !!isMatch);
          b.setAttribute('aria-pressed', isMatch ? 'true' : 'false');
        });
      }
      // Hook into city marker popups
      try {
        var cityMarkerMap = {
          "San José": marker_32f83795174731e53923e2d93bfcdab4,
          "Tamarindo": marker_0f2068c66c3e5ffe5c6bb909e537574c,
          "Jacó": marker_ffbb1e099febdb6fea9ac2ab69a36ce3,
          "Manuel Antonio": marker_6b06df13e29ebaf0c0a815a3171e0dc8,
          "Puerto Viejo": marker_bd8bcf8966901722f25a3c28351c816a
        };
        Object.keys(cityMarkerMap).forEach(function(city){
          var mk = cityMarkerMap[city];
          if (!mk || !mk.on) return;
          mk.on('popupopen', function(){
            try { selectedCity = city; } catch(e){}
            clearActiveRoute(); // remove any stale route when switching cities
            syncQuickJumpHighlight(city);
          });
          mk.on('popupclose', function(){
            try { if (typeof selectedCity !== 'undefined' && selectedCity === city) selectedCity = null; } catch(e){}
            // When no city popup is open, remove highlight
            syncQuickJumpHighlight(null);
          });
        });
      } catch(e) {}
      // Also clear route whenever any city popup is opened via programmatic open from Quick jump
      try {
        mapRef.on('popupopen', function(ev){
          // If the opened popup is attached to one of our city markers, we already handled above,
          // but this is a harmless safety net.
          clearActiveRoute();
        });
      } catch(e) {}
    })();

    
    // Mobile pan safety: idempotent enable/disable of interactions
    function crEnableMapInteraction() {
      try {
        if (!window.mapRef) return;
        mapRef.dragging && mapRef.dragging.enable();
        mapRef.touchZoom && mapRef.touchZoom.enable();
        mapRef.scrollWheelZoom && mapRef.scrollWheelZoom.enable();
        mapRef.doubleClickZoom && mapRef.doubleClickZoom.enable();
        mapRef.boxZoom && mapRef.boxZoom.enable();
        mapRef.keyboard && mapRef.keyboard.enable();
        document.body.classList.remove('cr-map-locked');
      } catch(e) {}
    }
    function crDisableMapInteraction() {
      try {
        if (!window.mapRef) return;
        mapRef.dragging && mapRef.dragging.disable();
        mapRef.touchZoom && mapRef.touchZoom.disable();
        mapRef.scrollWheelZoom && mapRef.scrollWheelZoom.disable();
        mapRef.doubleClickZoom && mapRef.doubleClickZoom.disable();
        mapRef.boxZoom && mapRef.boxZoom.disable();
        mapRef.keyboard && mapRef.keyboard.disable();
        document.body.classList.add('cr-map-locked');
      } catch(e) {}
    }

    // MOBILE FAB + SHEET (visibility fix)
    var fab = document.getElementById('cityFab');
    var sheet = document.getElementById('citySheet');
    var closeBtn = document.getElementById('closeSheetBtn');

    function updateFabVisibility(){
      if (!fab) return;
      if (isMobile()) { fab.style.display = 'block'; }
      else { fab.style.display = 'none'; if (sheet) sheet.classList.remove("open"); crEnableMapInteraction(); }
    }
    updateFabVisibility();
    window.addEventListener('resize', updateFabVisibility);

    if (fab && sheet) {
      fab.addEventListener('click', function(){
        sheet.classList.toggle('open');
        this.setAttribute('aria-expanded', sheet.classList.contains('open') ? 'true' : 'false');
      });
      if (closeBtn) closeBtn.addEventListener('click', ()=> sheet.classList.remove('open'));
    }

    // Mobile quick jump
    let selectedCityMobile = null;
    document.querySelectorAll('#citySheet .btn').forEach(btn=> {
      btn.addEventListener('click', ()=> {
        const city = btn.dataset.city;
        const lat = parseFloat(btn.dataset.lat);
        const lng = parseFloat(btn.dataset.lng);
        if (selectedCityMobile === city) {
          selectedCityMobile = null;
          Object.values({"San José": marker_32f83795174731e53923e2d93bfcdab4, "Tamarindo": marker_0f2068c66c3e5ffe5c6bb909e537574c, "Jacó": marker_ffbb1e099febdb6fea9ac2ab69a36ce3, "Manuel Antonio": marker_6b06df13e29ebaf0c0a815a3171e0dc8, "Puerto Viejo": marker_bd8bcf8966901722f25a3c28351c816a}).forEach(mk=> mk.closePopup && mk.closePopup());
          if (activeRouteLayer) { mapRef.removeLayer(activeRouteLayer); activeRouteLayer=null; }
          setTimeout(()=> resetToInitial(true), 120);
          sheet.classList.remove("open"); crEnableMapInteraction();
        } else {
          if (typeof activeRouteLayer !== 'undefined' && activeRouteLayer) { try { mapRef.removeLayer(activeRouteLayer); } catch(e){} activeRouteLayer = null; }

          selectedCityMobile = city;
          if (mapRef.flyTo) mapRef.flyTo([lat,lng], Math.max(mapRef.getZoom(), 11), {duration:.7}); else mapRef.setView([lat,lng], Math.max(mapRef.getZoom(), 11));
          const mk = {"San José": marker_32f83795174731e53923e2d93bfcdab4, "Tamarindo": marker_0f2068c66c3e5ffe5c6bb909e537574c, "Jacó": marker_ffbb1e099febdb6fea9ac2ab69a36ce3, "Manuel Antonio": marker_6b06df13e29ebaf0c0a815a3171e0dc8, "Puerto Viejo": marker_bd8bcf8966901722f25a3c28351c816a}[city];
          setTimeout(()=> mk && mk.openPopup && mk.openPopup(), 720);
          sheet.classList.remove("open"); crEnableMapInteraction();
        }
      });
    });

    
    // On mobile, clear any existing route whenever a popup opens (switching cities or airports)
    (function(){
      function isMobile(){ try { return window.matchMedia('(pointer: coarse)').matches || window.innerWidth <= 900; } catch(e){ return false; } }
      try {
        mapRef.on('popupopen', function(){
          if (!isMobile()) return;
          if (typeof activeRouteLayer !== 'undefined' && activeRouteLayer) {
            try { mapRef.removeLayer(activeRouteLayer); } catch(e){}
            activeRouteLayer = null;
          }
        });
      } catch(e){}
    })();

    // Airport popups (SJO/LIR bolding, top-3 rows)
    const airportLL = {"SJO": {"lat": 9.9939, "lng": -84.2088}, "LIR": {"lat": 10.5933, "lng": -85.5444}, "XQP": {"lat": 9.4432, "lng": -84.1298}, "TNO": {"lat": 10.3139, "lng": -85.8163}};
    const cityLL = {"San Jos\u00e9": {"lat": 9.93, "lng": -84.08}, "Tamarindo": {"lat": 10.3, "lng": -85.84}, "Jac\u00f3": {"lat": 9.62, "lng": -84.63}, "Manuel Antonio": {"lat": 9.39, "lng": -84.14}, "Puerto Viejo": {"lat": 9.66, "lng": -82.76}};
    const cityAirports = {"San Jos\u00e9": ["SJO"], "Tamarindo": ["LIR", "TNO"], "Jac\u00f3": ["SJO"], "Manuel Antonio": ["SJO", "XQP"], "Puerto Viejo": ["SJO"]};

    function miles(km) { return km * 0.621371; }
    function etaFromKm(km, kmh=55) { const mins = Math.round(km/kmh*60); const h=Math.floor(mins/60), m=mins%60; return h? (m?`${h} hr ${m} min`:`${h} hr`) : `${m} min`; }
    function distKm(a,b) { return mapRef.distance(L.latLng(a.lat,a.lng), L.latLng(b.lat,b.lng))/1000; }
    function gmaps(o,d) { return `https://www.google.com/maps/dir/?api=1&origin=${o.lat},${o.lng}&destination=${d.lat},${d.lng}&travelmode=driving`; }

    Object.entries(airportLL).forEach(([code, ll])=>{
      const rowsAll = Object.entries(cityLL).map(([n, cll])=>({ name:n, cll, dkm: distKm(ll,cll) })).sort((a,b)=>a.dkm-b.dkm);
      const intl = (code==='SJO'||code==='LIR');
      const relevant = new Set();
      if (intl) { Object.entries(cityAirports).forEach(([city, codes])=>{ if (codes.includes(code)) relevant.add(city); }); }
      const must = rowsAll.filter(r=>relevant.has(r.name));
      const extras = rowsAll.filter(r=>!relevant.has(r.name));
      let rows = must.length? must.concat(extras.slice(0, Math.max(0,3-must.length))) : rowsAll.slice(0,3);

      const list = rows.map(r=>{
        const bold = intl && relevant.has(r.name);
        const name = bold? `<b>${r.name}</b>` : r.name;
        const mi = Math.round(miles(r.dkm));
        const eta = etaFromKm(r.dkm);
        const dirOverlay = `<a href="#" onclick="routeAirportToCity('${code}','${r.name}');return false;">Directions</a>`;
        const openGM = `<a href="${gmaps(ll, r.cll)}" target="_blank" rel="noopener noreferrer">Open in Google Maps</a>`;
        return `<li>${name}: ${mi} mi (~${eta}) · ${dirOverlay} · ${openGM}</li>`;
      }).join('');

      L.marker([ll.lat,ll.lng], {opacity:0, interactive:true})
        .addTo(mapRef)
        .bindPopup(`<div class="cr-airport"><div class="cr-title" style="font-weight:800;font-size:20px;margin-bottom:4px;">${code} Airport</div><ul>${list}</ul></div>`);
    });
  });
</script>
    
            <div class="folium-map" id="map_c8689fa0fa819fbcc2c9e3f97e0c1fbb" ></div>
        

<div id="helpScrim" aria-hidden="true"></div>
<div id="helpPanel" role="complementary" aria-labelledby="helpTitle" aria-live="polite">
  <div class="hp-header">
    <h3 id="helpTitle">How to use this map</h3>
    <button id="helpToggle" type="button" aria-expanded="true" aria-controls="helpBody"></button>
  </div>
  <div id="helpBody">
    <p><strong>Click or tap a city</strong> label to open its info card with:</p>
    <ul>
      <li><span class="hint">🎭 Vibe</span> – quick feel of the place</li>
      <li><span class="hint">✅ Why it fits</span> – who it’s best for</li>
      <li><span class="hint">✈️ Airport</span> – <em>Directions</em> from listed airports + <em>Find flights</em></li>
      <li><span class="hint">🛏️ Stays</span> – Hotels.com &amp; Airbnb links (and official all‑inclusive resorts when applicable)</li>
      <li><span class="hint">🍸 Nightlife</span> &amp; <span class="hint">🛡️ Safety</span> – short notes</li>
      <li><span class="hint">🥾 Excursions</span> – clickable ideas</li>
      <li><span class="hint">🧭 Day Trips</span> – optional cross‑city options</li>
    </ul>
    <p><strong>Tap an airport</strong> (green plane) to see the <em>3 closest cities</em> with distance &amp; ETA, plus quick <em>Directions</em>.</p>
    <p class="hint">Desktop: use the <strong>Quick jump</strong> panel (right). Mobile: use the <strong>Cities</strong> button. Click/tap the same city again (or use <strong>Reset view</strong>) to return to the full map.</p>
  </div>
</div>


<button id="mobileResetBtn" type="button" aria-label="Reset to full map view" title="Reset view"></button>

<div id="introScrim" aria-hidden="true"></div>

<script>
// Mobile-only active city sync without changing desktop logic
(function(){
  function isMobile(){ try { return window.matchMedia('(pointer: coarse)').matches || window.innerWidth <= 900; } catch(e){ return false; } }
  var sheet = document.getElementById('citySheet');
  var fab = document.getElementById('cityFab');
  var sheetButtons = sheet ? Array.from(sheet.querySelectorAll('.btn')) : [];

  function findCityByLatLng(lat, lng){
    if (!sheetButtons.length) return null;
    var tol = 0.05; // ~5km tolerance in degrees
    for (var i=0;i<sheetButtons.length;i++){
      var b = sheetButtons[i];
      var bl = parseFloat(b.dataset.lat), bn = parseFloat(b.dataset.lng);
      if (Math.abs(bl - lat) <= tol && Math.abs(bn - lng) <= tol) return b.dataset.city;
    }
    return null;
  }

  function setActiveCityMobile(name){
    window.selectedCityMobile = name || null;
  }

  function clearRoute(){
    try {
      if (window.activeRouteLayer && window.mapRef) { mapRef.removeLayer(activeRouteLayer); activeRouteLayer = null; }
    } catch(e){}
  }

  // When a popup opens on the map (tapping a city while sheet is closed), update the active city
  function bindMapEvents(){
    if (!window.mapRef || !mapRef.on) return;
    mapRef.on('popupopen', function(e){
      if (!isMobile()) return;
      try {
        var content = (e && e.popup && e.popup.getContent && e.popup.getContent()) || "";
        // Skip airports (title like "SJO Airport")
        if (typeof content === 'string' && content.indexOf(' Airport</div>') !== -1) return;
        var src = e && e.popup && e.popup._source;
        if (src && src.getLatLng){
          var ll = src.getLatLng();
          var name = findCityByLatLng(ll.lat, ll.lng);
          if (name){
            clearRoute();
            setActiveCityMobile(name);
          }
        }
      } catch(err){}
    });
    mapRef.on('popupclose', function(e){
      if (!isMobile()) return;
      try {
        var src = e && e.popup && e.popup._source;
        if (src && src.getLatLng){
          var ll = src.getLatLng();
          var name = findCityByLatLng(ll.lat, ll.lng);
          if (name && window.selectedCityMobile === name){
            setActiveCityMobile(null);
          }
        }
      } catch(err){}
    });
  }

  // On opening the Cities sheet, reflect the current active city in highlight (but never auto-open)
  function bindFab(){
    if (!fab || !sheet) return;
    fab.addEventListener('click', function(){
      // After the sheet toggles open/closed, sync button highlights once
      setTimeout(function(){
        if (!sheet.classList.contains('open')) return;
        for (var i=0;i<sheetButtons.length;i++){
          var b = sheetButtons[i];
          var on = !!(window.selectedCityMobile && b.dataset.city === window.selectedCityMobile);
          b.classList.toggle('selected', on);
          b.setAttribute('aria-pressed', on ? 'true' : 'false');
        }
      }, 0);
    });
  }

  // Initialize
  bindMapEvents();
  bindFab();
})();
</script>

</body>
<script>
    
    
            var map_c8689fa0fa819fbcc2c9e3f97e0c1fbb = L.map(
                "map_c8689fa0fa819fbcc2c9e3f97e0c1fbb",
                {
                    center: [9.9, -84.2],
                    crs: L.CRS.EPSG3857,
                    zoom: 7,
                    zoomControl: true,
                    preferCanvas: false,
                }
            );

            

        
    
            var tile_layer_66e9d28bd07195868440b3e15228e57c = L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}", {"crossOrigin": true, "detectRetina": true, "attribution": "Tiles \u00a9 Esri \u2014 Source: Esri, Maxar, Earthstar Geographics", "detectRetina": false, "maxNativeZoom": 18, "maxZoom": 18, "minZoom": 0, "noWrap": false, "opacity": 1, "subdomains": "abc", "tms": false}).addTo(map_c8689fa0fa819fbcc2c9e3f97e0c1fbb);
        
    
            map_c8689fa0fa819fbcc2c9e3f97e0c1fbb.fitBounds(
                [[7.0, -87.0], [12.1, -82.0]],
                {}
            );
        
    
            var feature_group_bb72549b2887a5a72b55d485568543c4 = L.featureGroup(
                {}
            ).addTo(map_c8689fa0fa819fbcc2c9e3f97e0c1fbb);
        
    
            var marker_9c474d518516b604728ecf0f93d28cfb = L.marker(
                [9.9939, -84.2088],
                {}
            ).addTo(feature_group_bb72549b2887a5a72b55d485568543c4);
        
    
            var icon_85503f43799686d02c6734970dc3594d = L.AwesomeMarkers.icon(
                {"extraClasses": "fa-rotate-0", "icon": "plane", "iconColor": "white", "markerColor": "green", "prefix": "fa"}
            );
            marker_9c474d518516b604728ecf0f93d28cfb.setIcon(icon_85503f43799686d02c6734970dc3594d);
        
    
            marker_9c474d518516b604728ecf0f93d28cfb.bindTooltip(
                `<div>
                     SJO
                 </div>`,
                {"sticky": true}
            );
        
    
            var marker_c3bf8d0c234206e608ec8e8692cda6c3 = L.marker(
                [9.9939, -84.2088],
                {}
            ).addTo(feature_group_bb72549b2887a5a72b55d485568543c4);
        
    
            var div_icon_e44f5a40d6c7506598194d54aae961e7 = L.divIcon({"className": "empty", "html": "\u003cdiv style=\"font-size: 13px; font-weight: 800; color: #00ff99; text-shadow: 0 0 6px rgba(0,0,0,0.8); transform: translate(12px, -4px);\"\u003eSJO\u003c/div\u003e"});
            marker_c3bf8d0c234206e608ec8e8692cda6c3.setIcon(div_icon_e44f5a40d6c7506598194d54aae961e7);
        
    
            var marker_df6f6666c27866f16fa36a7212edea59 = L.marker(
                [10.5933, -85.5444],
                {}
            ).addTo(feature_group_bb72549b2887a5a72b55d485568543c4);
        
    
            var icon_6319e6d21f89eaecd38f76e305399a94 = L.AwesomeMarkers.icon(
                {"extraClasses": "fa-rotate-0", "icon": "plane", "iconColor": "white", "markerColor": "green", "prefix": "fa"}
            );
            marker_df6f6666c27866f16fa36a7212edea59.setIcon(icon_6319e6d21f89eaecd38f76e305399a94);
        
    
            marker_df6f6666c27866f16fa36a7212edea59.bindTooltip(
                `<div>
                     LIR
                 </div>`,
                {"sticky": true}
            );
        
    
            var marker_67234d418f989895dc64d660272a7df4 = L.marker(
                [10.5933, -85.5444],
                {}
            ).addTo(feature_group_bb72549b2887a5a72b55d485568543c4);
        
    
            var div_icon_4b3a605359d173d6f8b0f62e23ac0fa6 = L.divIcon({"className": "empty", "html": "\u003cdiv style=\"font-size: 13px; font-weight: 800; color: #00ff99; text-shadow: 0 0 6px rgba(0,0,0,0.8); transform: translate(12px, -4px);\"\u003eLIR\u003c/div\u003e"});
            marker_67234d418f989895dc64d660272a7df4.setIcon(div_icon_4b3a605359d173d6f8b0f62e23ac0fa6);
        
    
            var marker_2146042a7f21a7a91b39c0b492b9219d = L.marker(
                [9.4432, -84.1298],
                {}
            ).addTo(feature_group_bb72549b2887a5a72b55d485568543c4);
        
    
            var icon_c9a706e8a952e2ccf005b6c0ac8ffe25 = L.AwesomeMarkers.icon(
                {"extraClasses": "fa-rotate-0", "icon": "plane", "iconColor": "white", "markerColor": "green", "prefix": "fa"}
            );
            marker_2146042a7f21a7a91b39c0b492b9219d.setIcon(icon_c9a706e8a952e2ccf005b6c0ac8ffe25);
        
    
            marker_2146042a7f21a7a91b39c0b492b9219d.bindTooltip(
                `<div>
                     XQP
                 </div>`,
                {"sticky": true}
            );
        
    
            var marker_0838d301afb64f7a359c41270a27efa1 = L.marker(
                [9.4432, -84.1298],
                {}
            ).addTo(feature_group_bb72549b2887a5a72b55d485568543c4);
        
    
            var div_icon_bf0967e49f742659e927277bcadb64ab = L.divIcon({"className": "empty", "html": "\u003cdiv style=\"font-size: 13px; font-weight: 800; color: #00ff99; text-shadow: 0 0 6px rgba(0,0,0,0.8); transform: translate(12px, -4px);\"\u003eXQP\u003c/div\u003e"});
            marker_0838d301afb64f7a359c41270a27efa1.setIcon(div_icon_bf0967e49f742659e927277bcadb64ab);
        
    
            var marker_5b9730c9249d8a901ed513fbdca7c86f = L.marker(
                [10.3139, -85.8163],
                {}
            ).addTo(feature_group_bb72549b2887a5a72b55d485568543c4);
        
    
            var icon_7a82902671a021072fd5ae11f4f59ab4 = L.AwesomeMarkers.icon(
                {"extraClasses": "fa-rotate-0", "icon": "plane", "iconColor": "white", "markerColor": "green", "prefix": "fa"}
            );
            marker_5b9730c9249d8a901ed513fbdca7c86f.setIcon(icon_7a82902671a021072fd5ae11f4f59ab4);
        
    
            marker_5b9730c9249d8a901ed513fbdca7c86f.bindTooltip(
                `<div>
                     TNO
                 </div>`,
                {"sticky": true}
            );
        
    
            var marker_70de1b1aba10fc8efecb7d9f664fb4fb = L.marker(
                [10.3139, -85.8163],
                {}
            ).addTo(feature_group_bb72549b2887a5a72b55d485568543c4);
        
    
            var div_icon_22b26c471e772a3ff17d84a33b93c7f6 = L.divIcon({"className": "empty", "html": "\u003cdiv style=\"font-size: 13px; font-weight: 800; color: #00ff99; text-shadow: 0 0 6px rgba(0,0,0,0.8); transform: translate(12px, -4px);\"\u003eTNO\u003c/div\u003e"});
            marker_70de1b1aba10fc8efecb7d9f664fb4fb.setIcon(div_icon_22b26c471e772a3ff17d84a33b93c7f6);
        
    
            var circle_marker_037584f3b00f8b240704940770c2a850 = L.circleMarker(
                [9.93, -84.08],
                {"bubblingMouseEvents": true, "color": "#ffffff", "dashArray": null, "dashOffset": null, "fill": true, "fillColor": "#ffffff", "fillOpacity": 0.95, "fillRule": "evenodd", "lineCap": "round", "lineJoin": "round", "opacity": 1.0, "radius": 6, "stroke": true, "weight": 3}
            ).addTo(map_c8689fa0fa819fbcc2c9e3f97e0c1fbb);
        
    
            var marker_efeb6163ec3aacaffd14642effe2c0ee = L.marker(
                [9.93, -84.08],
                {}
            ).addTo(map_c8689fa0fa819fbcc2c9e3f97e0c1fbb);
        
    
            var div_icon_8184efed8b844d037a147203f577de09 = L.divIcon({"className": "empty", "html": "\u003cdiv style=\"font-size: 16px; font-weight: 800; color: #ffffff; text-shadow: 0 0 6px rgba(0,0,0,0.85); transform: translate(16px, -6px);\"\u003eSan Jos\u00e9\u003c/div\u003e"});
            marker_efeb6163ec3aacaffd14642effe2c0ee.setIcon(div_icon_8184efed8b844d037a147203f577de09);
        
    
            var marker_32f83795174731e53923e2d93bfcdab4 = L.marker(
                [9.93, -84.08],
                {}
            ).addTo(map_c8689fa0fa819fbcc2c9e3f97e0c1fbb);
        
    
            var icon_c11972c065928f0a03a84b7e1ed9b71e = L.AwesomeMarkers.icon(
                {"extraClasses": "fa-rotate-0", "icon": "info-sign", "iconColor": "white", "markerColor": "white", "prefix": "glyphicon"}
            );
            marker_32f83795174731e53923e2d93bfcdab4.setIcon(icon_c11972c065928f0a03a84b7e1ed9b71e);
        
    
        var popup_8c503b9748e7ec565642e9ba0e9e684b = L.popup({"maxWidth": 420});

        
            var html_6f3daf0580b157a1d85fdc58a8b820c2 = $(`<div id="html_6f3daf0580b157a1d85fdc58a8b820c2" style="width: 100.0%; height: 100.0%;">     <div class="cr-popup" style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;">         <div class="cr-title" style="font-weight: 800; font-size: 20px;"><b>San José</b></div>         <ul class="cr-list" style="padding-left: 16px; margin: 0; font-size: 16px; line-height: 1.5; color: #111;">             <li><b>🎭 Vibe</b>: Capital culture—museums, theatre, craft bars.</li>             <li><b>✅ Why it fits</b>: Best big‑city dining & nightlife; good for 1–2 nights.</li>             <li><b>✈️ Airport</b>: SJO (~17 min) <a href="#" onclick="routeCityToAirport('San José','SJO');return false;">Directions</a> | <a href="https://flights.google.com" target="_blank" rel="noopener noreferrer">Find flights</a></li>             <li><b>🛏️ Stay types</b>:</li>                 <ul class="cr-sublist" style="padding-left: 16px; margin: 0;"><li>🏨 <a href="https://www.hotels.com/Hotel-Search?destination=San%20Jos%C3%A9%2C%20San%20Jos%C3%A9%20Province%2C%20Costa%20Rica&startDate=2026-01-15&endDate=2026-01-20&upsellingNumNightsAdded=&theme=&userIntent=&semdtl=&upsellingDiscountTypeAdded=&categorySearch=&useRewards=false&sort=RECOMMENDED&adults=2&children=&latLong=&daysInFuture&stayLength&paymentType=PAY_LATER&guestRating=40&stay_options_group=hotels_option&regionId=3177&flexibility=1_DAY&pwaDialog=" target="_blank" rel="noopener noreferrer">Hotels</a></li><li>🏡 <a href="https://www.airbnb.com/s/San-Jos%C3%A9-Province--Costa-Rica/homes?refinement_paths%5B%5D=%2Fhomes&place_id=ChIJxRUNxULjoI8RNuhDZCmsjv8&checkin=2026-01-15&checkout=2026-01-20&adults=6&query=San%20Jos%C3%A9%20Province%2C%20Costa%20Rica&flexible_trip_lengths%5B%5D=one_week&monthly_start_date=2025-09-01&monthly_length=3&monthly_end_date=2025-12-01&search_mode=regular_search&price_filter_input_type=2&channel=EXPLORE&source=structured_search_input_header&search_type=user_map_move&ne_lat=10.228066169205295&ne_lng=-83.88856649747908&sw_lat=9.652876431685845&sw_lng=-84.40957267869885&zoom=10.26791434723343&zoom_level=10.26791434723343&search_by_map=true&price_filter_num_nights=5" target="_blank" rel="noopener noreferrer">Airbnb</a></li></ul>             <li><b>🍸 Nightlife</b>: Cocktail bars & clubs in Escazú; gastropubs in Escalante; live music downtown.</li>             <li><b>🛡️ Safety</b>: Typical big‑city precautions; use rideshare at night.</li>             <li><b>🥾 Excursions</b>:</li>                 <ul class="cr-sublist" style="padding-left: 16px; margin: 0;"><li><a href="https://www.google.com/search?q=Britt+Coffee+Tour+%28Heredia%29+San+Jos%C3%A9" target="_blank" rel="noopener noreferrer">Britt Coffee Tour (Heredia)</a></li><li><a href="https://www.google.com/search?q=Doka+Coffee+Estate+San+Jos%C3%A9" target="_blank" rel="noopener noreferrer">Doka Coffee Estate</a></li><li><a href="https://www.google.com/search?q=Po%C3%A1s+Volcano+National+Park+San+Jos%C3%A9" target="_blank" rel="noopener noreferrer">Poás Volcano National Park</a></li><li><a href="https://www.google.com/search?q=Iraz%C3%BA+Volcano+National+Park+San+Jos%C3%A9" target="_blank" rel="noopener noreferrer">Irazú Volcano National Park</a></li><li><a href="https://www.google.com/search?q=La+Paz+Waterfall+Gardens+San+Jos%C3%A9" target="_blank" rel="noopener noreferrer">La Paz Waterfall Gardens</a></li></ul>             <br>             <li><b>🧭 Optional Day Trips</b></li>                 <ul class="cr-sublist" style="padding-left: 16px; margin: 0;"><li><a href="https://www.google.com/search?q=La+Fortuna+%2F+Arenal+San+Jos%C3%A9" target="_blank" rel="noopener noreferrer">La Fortuna / Arenal</a></li><li><a href="https://www.google.com/search?q=Monteverde+Cloud+Forest+San+Jos%C3%A9" target="_blank" rel="noopener noreferrer">Monteverde Cloud Forest</a></li></ul>         </ul>     </div>     </div>`)[0];
            popup_8c503b9748e7ec565642e9ba0e9e684b.setContent(html_6f3daf0580b157a1d85fdc58a8b820c2);
        

        marker_32f83795174731e53923e2d93bfcdab4.bindPopup(popup_8c503b9748e7ec565642e9ba0e9e684b)
        ;

        
    
    
            var circle_marker_dad1bcf34bc3b17e2893577146b987df = L.circleMarker(
                [10.3, -85.84],
                {"bubblingMouseEvents": true, "color": "#ffffff", "dashArray": null, "dashOffset": null, "fill": true, "fillColor": "#ffffff", "fillOpacity": 0.95, "fillRule": "evenodd", "lineCap": "round", "lineJoin": "round", "opacity": 1.0, "radius": 6, "stroke": true, "weight": 3}
            ).addTo(map_c8689fa0fa819fbcc2c9e3f97e0c1fbb);
        
    
            var marker_ce016e545e7d63c993d5600954b311d2 = L.marker(
                [10.3, -85.84],
                {}
            ).addTo(map_c8689fa0fa819fbcc2c9e3f97e0c1fbb);
        
    
            var div_icon_f0cafef3b6beaf5db43dc012bb8637ce = L.divIcon({"className": "empty", "html": "\u003cdiv style=\"font-size: 16px; font-weight: 800; color: #ffffff; text-shadow: 0 0 6px rgba(0,0,0,0.85); transform: translate(16px, 6px);\"\u003eTamarindo\u003c/div\u003e"});
            marker_ce016e545e7d63c993d5600954b311d2.setIcon(div_icon_f0cafef3b6beaf5db43dc012bb8637ce);
        
    
            var marker_0f2068c66c3e5ffe5c6bb909e537574c = L.marker(
                [10.3, -85.84],
                {}
            ).addTo(map_c8689fa0fa819fbcc2c9e3f97e0c1fbb);
        
    
            var icon_7406d0203b6efef538d5b8b069aaf115 = L.AwesomeMarkers.icon(
                {"extraClasses": "fa-rotate-0", "icon": "info-sign", "iconColor": "white", "markerColor": "white", "prefix": "glyphicon"}
            );
            marker_0f2068c66c3e5ffe5c6bb909e537574c.setIcon(icon_7406d0203b6efef538d5b8b069aaf115);
        
    
        var popup_1442df7b71b8fbb31290a476fd695efa = L.popup({"maxWidth": 420});

        
            var html_114acac0e99c7e939ef2e290716f7bfc = $(`<div id="html_114acac0e99c7e939ef2e290716f7bfc" style="width: 100.0%; height: 100.0%;">     <div class="cr-popup" style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;">         <div class="cr-title" style="font-weight: 800; font-size: 20px;"><b>Tamarindo</b></div>         <ul class="cr-list" style="padding-left: 16px; margin: 0; font-size: 16px; line-height: 1.5; color: #111;">             <li><b>🎭 Vibe</b>: Surf town + sunset bars, very walkable.</li>             <li><b>✅ Why it fits</b>: Blend of beach, restaurants, and nightlife in Guanacaste.</li>             <li><b>✈️ Airport</b>: LIR (~50 min) <a href="#" onclick="routeCityToAirport('Tamarindo','LIR');return false;">Directions</a> • TNO (~3 min) <a href="#" onclick="routeCityToAirport('Tamarindo','TNO');return false;">Directions</a> | <a href="https://flights.google.com" target="_blank" rel="noopener noreferrer">Find flights</a></li>             <li><b>🛏️ Stay types</b>:</li>                 <ul class="cr-sublist" style="padding-left: 16px; margin: 0;"><li>🏨 <a href="https://www.hotels.com/Hotel-Search?destination=Tamarindo%2C%20Guanacaste%2C%20Costa%20Rica&startDate=2026-01-15&endDate=2026-01-20&upsellingNumNightsAdded=&theme=&userIntent=&semdtl=&upsellingDiscountTypeAdded=&categorySearch=&useRewards=false&sort=RECOMMENDED&paymentType=PAY_LATER&stay_options_group=hotels_option&guestRating=40&regionId=500187&adults=2&children=&flexibility=1_DAY&latLong&pwaDialog=&daysInFuture&stayLength" target="_blank" rel="noopener noreferrer">Hotels</a></li><li>🏡 <a href="https://www.airbnb.com/s/Tamarindo--Costa-Rica/homes?refinement_paths%5B%5D=%2Fhomes&place_id=ChIJD8MDkkA5no8Rk_jBLF6fGLs&checkin=2026-01-15&checkout=2026-01-20&adults=6&query=Tamarindo%2C%20Costa%20Rica&flexible_trip_lengths%5B%5D=one_week&monthly_start_date=2025-09-01&monthly_length=3&monthly_end_date=2025-12-01&search_mode=regular_search&price_filter_input_type=2&price_filter_num_nights=5&channel=EXPLORE&source=structured_search_input_header&search_type=unknown" target="_blank" rel="noopener noreferrer">Airbnb</a></li><li>🏝️ Resort → <a href="https://www.riu.com/en/hotel/costa-rica/guanacaste/hotel-riu-guanacaste/" target="_blank" rel="noopener noreferrer">Riu Guanacaste</a></li><li>🏝️ Resort → <a href="https://www.riu.com/en/hotel/costa-rica/guanacaste/hotel-riu-palace-costa-rica/" target="_blank" rel="noopener noreferrer">Riu Palace Costa Rica</a></li></ul>             <li><b>🍸 Nightlife</b>: Beach clubs, breweries, late‑night spots on the strip.</li>             <li><b>🛡️ Safety</b>: Watch petty theft; keep valuables close after dark.</li>             <li><b>🥾 Excursions</b>:</li>                 <ul class="cr-sublist" style="padding-left: 16px; margin: 0;"><li><a href="https://www.google.com/search?q=Sunset+Catamaran+%28departure+beach%29+Tamarindo" target="_blank" rel="noopener noreferrer">Sunset Catamaran (departure beach)</a></li><li><a href="https://www.google.com/search?q=Estuary+Boat%2FKayak+%28mangroves%29+Tamarindo" target="_blank" rel="noopener noreferrer">Estuary Boat/Kayak (mangroves)</a></li><li><a href="https://www.google.com/search?q=Las+Baulas+National+Park+%2F+Playa+Grande+Tamarindo" target="_blank" rel="noopener noreferrer">Las Baulas National Park / Playa Grande</a></li><li><a href="https://www.google.com/search?q=Rinc%C3%B3n+de+la+Vieja+National+Park+Tamarindo" target="_blank" rel="noopener noreferrer">Rincón de la Vieja National Park</a></li></ul>             <br>             <li><b>🧭 Optional Day Trips</b></li>                 <ul class="cr-sublist" style="padding-left: 16px; margin: 0;"><li><a href="https://www.google.com/search?q=Rinc%C3%B3n+de+la+Vieja+National+Park+Tamarindo" target="_blank" rel="noopener noreferrer">Rincón de la Vieja National Park</a></li><li><a href="https://www.google.com/search?q=La+Fortuna+%2F+Arenal+Tamarindo" target="_blank" rel="noopener noreferrer">La Fortuna / Arenal</a></li></ul>         </ul>     </div>     </div>`)[0];
            popup_1442df7b71b8fbb31290a476fd695efa.setContent(html_114acac0e99c7e939ef2e290716f7bfc);
        

        marker_0f2068c66c3e5ffe5c6bb909e537574c.bindPopup(popup_1442df7b71b8fbb31290a476fd695efa)
        ;

        
    
    
            var circle_marker_fe20aedb39fa92a42508133d13961514 = L.circleMarker(
                [9.62, -84.63],
                {"bubblingMouseEvents": true, "color": "#ffffff", "dashArray": null, "dashOffset": null, "fill": true, "fillColor": "#ffffff", "fillOpacity": 0.95, "fillRule": "evenodd", "lineCap": "round", "lineJoin": "round", "opacity": 1.0, "radius": 6, "stroke": true, "weight": 3}
            ).addTo(map_c8689fa0fa819fbcc2c9e3f97e0c1fbb);
        
    
            var marker_8390326c42d54f8f5271946d883100b0 = L.marker(
                [9.62, -84.63],
                {}
            ).addTo(map_c8689fa0fa819fbcc2c9e3f97e0c1fbb);
        
    
            var div_icon_bfae422708268b11aab26219328c4cbb = L.divIcon({"className": "empty", "html": "\u003cdiv style=\"font-size: 16px; font-weight: 800; color: #ffffff; text-shadow: 0 0 6px rgba(0,0,0,0.85); transform: translate(16px, -6px);\"\u003eJac\u00f3\u003c/div\u003e"});
            marker_8390326c42d54f8f5271946d883100b0.setIcon(div_icon_bfae422708268b11aab26219328c4cbb);
        
    
            var marker_ffbb1e099febdb6fea9ac2ab69a36ce3 = L.marker(
                [9.62, -84.63],
                {}
            ).addTo(map_c8689fa0fa819fbcc2c9e3f97e0c1fbb);
        
    
            var icon_17e9f577750b173e6152c167ea83c68f = L.AwesomeMarkers.icon(
                {"extraClasses": "fa-rotate-0", "icon": "info-sign", "iconColor": "white", "markerColor": "white", "prefix": "glyphicon"}
            );
            marker_ffbb1e099febdb6fea9ac2ab69a36ce3.setIcon(icon_17e9f577750b173e6152c167ea83c68f);
        
    
        var popup_ed06b13e3138504bc2e159fb3f9cfb9c = L.popup({"maxWidth": 420});

        
            var html_4329bef3fab1374ad3741bd1124e64b0 = $(`<div id="html_4329bef3fab1374ad3741bd1124e64b0" style="width: 100.0%; height: 100.0%;">     <div class="cr-popup" style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;">         <div class="cr-title" style="font-weight: 800; font-size: 20px;"><b>Jacó</b></div>         <ul class="cr-list" style="padding-left: 16px; margin: 0; font-size: 16px; line-height: 1.5; color: #111;">             <li><b>🎭 Vibe</b>: Lively party/surf town on the Central Pacific.</li>             <li><b>✅ Why it fits</b>: Most concentrated nightlife on the coast; easy from SJO.</li>             <li><b>✈️ Airport</b>: SJO (~1 hr 8 min) <a href="#" onclick="routeCityToAirport('Jacó','SJO');return false;">Directions</a> | <a href="https://flights.google.com" target="_blank" rel="noopener noreferrer">Find flights</a></li>             <li><b>🛏️ Stay types</b>:</li>                 <ul class="cr-sublist" style="padding-left: 16px; margin: 0;"><li>🏨 <a href="https://www.hotels.com/Hotel-Search?destination=Jac%C3%B3%2C%20Puntarenas%20Province%2C%20Costa%20Rica&startDate=2026-01-15&endDate=2026-01-20&upsellingNumNightsAdded=&theme=&userIntent=&semdtl=&upsellingDiscountTypeAdded=&categorySearch=&useRewards=false&sort=RECOMMENDED&adults=2&children=&latLong=&daysInFuture&stayLength&paymentType=PAY_LATER&stay_options_group=hotels_option&regionId=6052932&guestRating=40&flexibility=1_DAY&pwaDialog=" target="_blank" rel="noopener noreferrer">Hotels</a></li><li>🏡 <a href="https://www.airbnb.com/s/Jaco--Costa-Rica/homes?refinement_paths%5B%5D=%2Fhomes&place_id=ChIJgwxhuWrHoY8R9t2Ppf9-8xs&checkin=2026-01-15&checkout=2026-01-20&adults=6&query=Jaco%2C%20Costa%20Rica&flexible_trip_lengths%5B%5D=one_week&monthly_start_date=2025-09-01&monthly_length=3&monthly_end_date=2025-12-01&search_mode=regular_search&price_filter_input_type=2&price_filter_num_nights=5&channel=EXPLORE&source=structured_search_input_header&search_type=unknown" target="_blank" rel="noopener noreferrer">Airbnb</a></li><li>🏝️ Resort → <a href="https://www.crocsresortcasino.com/" target="_blank" rel="noopener noreferrer">Croc’s Resort & Casino</a></li><li>🏝️ Resort → <a href="https://www.bestwestern.com/en_US/book/hotels-in-jaco-beach/best-western-jaco-beach-all-inclusive-resort/propertyCode.70602.html" target="_blank" rel="noopener noreferrer">Best Western Jacó Beach</a></li></ul>             <li><b>🍸 Nightlife</b>: Clubs, bars, and late eats along Pastor Díaz Ave.</li>             <li><b>🛡️ Safety</b>: Busy scene—mind belongings; avoid isolated areas late.</li>             <li><b>🥾 Excursions</b>:</li>                 <ul class="cr-sublist" style="padding-left: 16px; margin: 0;"><li><a href="https://www.google.com/search?q=ATV+Jungle%2FWaterfall+Tours+Jac%C3%B3" target="_blank" rel="noopener noreferrer">ATV Jungle/Waterfall Tours</a></li><li><a href="https://www.google.com/search?q=T%C3%A1rcoles+Crocodile+Safari+Jac%C3%B3" target="_blank" rel="noopener noreferrer">Tárcoles Crocodile Safari</a></li><li><a href="https://www.google.com/search?q=Carara+National+Park+Jac%C3%B3" target="_blank" rel="noopener noreferrer">Carara National Park</a></li><li><a href="https://www.google.com/search?q=Horseback+Waterfall+Ride+Jac%C3%B3" target="_blank" rel="noopener noreferrer">Horseback Waterfall Ride</a></li></ul>             <br>             <li><b>🧭 Optional Day Trips</b></li>                 <ul class="cr-sublist" style="padding-left: 16px; margin: 0;"><li><a href="https://www.google.com/search?q=Manuel+Antonio+Jac%C3%B3" target="_blank" rel="noopener noreferrer">Manuel Antonio</a></li><li><a href="https://www.google.com/search?q=Monteverde+Cloud+Forest+Jac%C3%B3" target="_blank" rel="noopener noreferrer">Monteverde Cloud Forest</a></li></ul>         </ul>     </div>     </div>`)[0];
            popup_ed06b13e3138504bc2e159fb3f9cfb9c.setContent(html_4329bef3fab1374ad3741bd1124e64b0);
        

        marker_ffbb1e099febdb6fea9ac2ab69a36ce3.bindPopup(popup_ed06b13e3138504bc2e159fb3f9cfb9c)
        ;

        
    
    
            var circle_marker_d1967ca1216c7c925035c3ddef5fd6c6 = L.circleMarker(
                [9.39, -84.14],
                {"bubblingMouseEvents": true, "color": "#ffffff", "dashArray": null, "dashOffset": null, "fill": true, "fillColor": "#ffffff", "fillOpacity": 0.95, "fillRule": "evenodd", "lineCap": "round", "lineJoin": "round", "opacity": 1.0, "radius": 6, "stroke": true, "weight": 3}
            ).addTo(map_c8689fa0fa819fbcc2c9e3f97e0c1fbb);
        
    
            var marker_ae295a0927b0ed0f01af6d8909fdc366 = L.marker(
                [9.39, -84.14],
                {}
            ).addTo(map_c8689fa0fa819fbcc2c9e3f97e0c1fbb);
        
    
            var div_icon_bdc128bb8ebef065fc9a408d8b577523 = L.divIcon({"className": "empty", "html": "\u003cdiv style=\"font-size: 16px; font-weight: 800; color: #ffffff; text-shadow: 0 0 6px rgba(0,0,0,0.85); transform: translate(16px, 6px);\"\u003eManuel Antonio\u003c/div\u003e"});
            marker_ae295a0927b0ed0f01af6d8909fdc366.setIcon(div_icon_bdc128bb8ebef065fc9a408d8b577523);
        
    
            var marker_6b06df13e29ebaf0c0a815a3171e0dc8 = L.marker(
                [9.39, -84.14],
                {}
            ).addTo(map_c8689fa0fa819fbcc2c9e3f97e0c1fbb);
        
    
            var icon_4c69522d8a4524e42a93e82fe88df3d4 = L.AwesomeMarkers.icon(
                {"extraClasses": "fa-rotate-0", "icon": "info-sign", "iconColor": "white", "markerColor": "white", "prefix": "glyphicon"}
            );
            marker_6b06df13e29ebaf0c0a815a3171e0dc8.setIcon(icon_4c69522d8a4524e42a93e82fe88df3d4);
        
    
        var popup_f03c573d3314d3864d7c348b81de9ef4 = L.popup({"maxWidth": 420});

        
            var html_aeadd98ad911af747543d23677075c2d = $(`<div id="html_aeadd98ad911af747543d23677075c2d" style="width: 100.0%; height: 100.0%;">     <div class="cr-popup" style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;">         <div class="cr-title" style="font-weight: 800; font-size: 20px;"><b>Manuel Antonio</b></div>         <ul class="cr-list" style="padding-left: 16px; margin: 0; font-size: 16px; line-height: 1.5; color: #111;">             <li><b>🎭 Vibe</b>: Scenic beaches + wildlife at the national park.</li>             <li><b>✅ Why it fits</b>: Great restaurants & views; calmer than Jacó.</li>             <li><b>✈️ Airport</b>: SJO (~1 hr 14 min) <a href="#" onclick="routeCityToAirport('Manuel Antonio','SJO');return false;">Directions</a> • XQP (~7 min) <a href="#" onclick="routeCityToAirport('Manuel Antonio','XQP');return false;">Directions</a> | <a href="https://flights.google.com" target="_blank" rel="noopener noreferrer">Find flights</a></li>             <li><b>🛏️ Stay types</b>:</li>                 <ul class="cr-sublist" style="padding-left: 16px; margin: 0;"><li>🏨 <a href="https://www.hotels.com/Hotel-Search?adults=2&categorySearch=&children=&daysInFuture&destination=Manuel%20Antonio%2C%20Quepos%2C%20Puntarenas%20Province%2C%20Costa%20Rica&endDate=2026-01-20&semdtl=&sort=RECOMMENDED&startDate=2026-01-15&stayLength&theme=&upsellingDiscountTypeAdded=&upsellingNumNightsAdded=&useRewards=false&userIntent=&paymentType=PAY_LATER&guestRating=40&stay_options_group=hotels_option&regionId=601060&flexibility=1_DAY&latLong&pwaDialog=&latLong%C2%AEionId=601060" target="_blank" rel="noopener noreferrer">Hotels</a></li><li>🏡 <a href="https://www.airbnb.com/s/Manuel-Antonio--Puntarenas--Costa-Rica/homes?refinement_paths%5B%5D=%2Fhomes&checkin=2026-01-15&checkout=2026-01-20&adults=6&flexible_trip_lengths%5B%5D=one_week&monthly_start_date=2025-09-01&monthly_length=3&monthly_end_date=2025-12-01&price_filter_input_type=2&price_filter_num_nights=5&channel=EXPLORE&source=structured_search_input_header&search_type=autocomplete_click&place_id=ChIJx1lfVH1xoY8RzroyZ2opBls&location_bb=QRacT8KoS3VBFm7gwqhSIw%3D%3D&acp_id=b7393cc6-3fa4-45aa-a7c6-9a5c1bc39048&date_picker_type=calendar" target="_blank" rel="noopener noreferrer">Airbnb</a></li><li>🏝️ Resort → <a href="https://www.hotelparador.com/" target="_blank" rel="noopener noreferrer">Parador Nature Resort & Spa</a></li></ul>             <li><b>🍸 Nightlife</b>: Cocktail bars & live music; chill vibe.</li>             <li><b>🛡️ Safety</b>: Tourist zone; standard precautions.</li>             <li><b>🥾 Excursions</b>:</li>                 <ul class="cr-sublist" style="padding-left: 16px; margin: 0;"><li><a href="https://www.google.com/search?q=Manuel+Antonio+National+Park+entrance+Manuel+Antonio" target="_blank" rel="noopener noreferrer">Manuel Antonio National Park entrance</a></li><li><a href="https://www.google.com/search?q=Quepos+Marina+dolphin%2Fsnorkel+cruise+Manuel+Antonio" target="_blank" rel="noopener noreferrer">Quepos Marina dolphin/snorkel cruise</a></li><li><a href="https://www.google.com/search?q=Damas+Island+Mangrove+Kayak+Manuel+Antonio" target="_blank" rel="noopener noreferrer">Damas Island Mangrove Kayak</a></li><li><a href="https://www.google.com/search?q=Savegre+River+Whitewater+Rafting+Manuel+Antonio" target="_blank" rel="noopener noreferrer">Savegre River Whitewater Rafting</a></li><li><a href="https://www.google.com/search?q=Naranjo+River+Whitewater+Rafting+Manuel+Antonio" target="_blank" rel="noopener noreferrer">Naranjo River Whitewater Rafting</a></li></ul>             <br>             <li><b>🧭 Optional Day Trips</b></li>                 <ul class="cr-sublist" style="padding-left: 16px; margin: 0;"><li><a href="https://www.google.com/search?q=Jac%C3%B3+Manuel+Antonio" target="_blank" rel="noopener noreferrer">Jacó</a></li><li><a href="https://www.google.com/search?q=Dominical+Manuel+Antonio" target="_blank" rel="noopener noreferrer">Dominical</a></li><li><a href="https://www.google.com/search?q=Uvita+%28Whale%E2%80%99s+Tail+%2F+Marino+Ballena+NP%29+Manuel+Antonio" target="_blank" rel="noopener noreferrer">Uvita (Whale’s Tail / Marino Ballena NP)</a></li></ul>         </ul>     </div>     </div>`)[0];
            popup_f03c573d3314d3864d7c348b81de9ef4.setContent(html_aeadd98ad911af747543d23677075c2d);
        

        marker_6b06df13e29ebaf0c0a815a3171e0dc8.bindPopup(popup_f03c573d3314d3864d7c348b81de9ef4)
        ;

        
    
    
            var circle_marker_73c6a935c1c96b390c8a37385abd8c71 = L.circleMarker(
                [9.66, -82.76],
                {"bubblingMouseEvents": true, "color": "#ffffff", "dashArray": null, "dashOffset": null, "fill": true, "fillColor": "#ffffff", "fillOpacity": 0.95, "fillRule": "evenodd", "lineCap": "round", "lineJoin": "round", "opacity": 1.0, "radius": 6, "stroke": true, "weight": 3}
            ).addTo(map_c8689fa0fa819fbcc2c9e3f97e0c1fbb);
        
    
            var marker_cce687668b8f7d099c387abb974ed154 = L.marker(
                [9.66, -82.76],
                {}
            ).addTo(map_c8689fa0fa819fbcc2c9e3f97e0c1fbb);
        
    
            var div_icon_1f47f66f023c1dec062562e44a83d1bf = L.divIcon({"className": "empty", "html": "\u003cdiv style=\"font-size: 16px; font-weight: 800; color: #ffffff; text-shadow: 0 0 6px rgba(0,0,0,0.85); transform: translate(16px, 6px);\"\u003ePuerto Viejo\u003c/div\u003e"});
            marker_cce687668b8f7d099c387abb974ed154.setIcon(div_icon_1f47f66f023c1dec062562e44a83d1bf);
        
    
            var marker_bd8bcf8966901722f25a3c28351c816a = L.marker(
                [9.66, -82.76],
                {}
            ).addTo(map_c8689fa0fa819fbcc2c9e3f97e0c1fbb);
        
    
            var icon_a4a535994f74a698b5b708432148e3d5 = L.AwesomeMarkers.icon(
                {"extraClasses": "fa-rotate-0", "icon": "info-sign", "iconColor": "white", "markerColor": "white", "prefix": "glyphicon"}
            );
            marker_bd8bcf8966901722f25a3c28351c816a.setIcon(icon_a4a535994f74a698b5b708432148e3d5);
        
    
        var popup_11f54db00fc4d587f66adf58174c9c29 = L.popup({"maxWidth": 420});

        
            var html_38a6b558815dd03beba017cc83c72485 = $(`<div id="html_38a6b558815dd03beba017cc83c72485" style="width: 100.0%; height: 100.0%;">     <div class="cr-popup" style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;">         <div class="cr-title" style="font-weight: 800; font-size: 20px;"><b>Puerto Viejo</b></div>         <ul class="cr-list" style="padding-left: 16px; margin: 0; font-size: 16px; line-height: 1.5; color: #111;">             <li><b>🎭 Vibe</b>: Afro‑Caribbean vibe—reggae, cafés, great food.</li>             <li><b>✅ Why it fits</b>: Distinct culture & nightlife; beaches like Cocles.</li>             <li><b>✈️ Airport</b>: SJO (~2 hr 58 min) <a href="#" onclick="routeCityToAirport('Puerto Viejo','SJO');return false;">Directions</a> | <a href="https://flights.google.com" target="_blank" rel="noopener noreferrer">Find flights</a></li>             <li><b>🛏️ Stay types</b>:</li>                 <ul class="cr-sublist" style="padding-left: 16px; margin: 0;"><li>🏨 <a href="https://www.hotels.com/Hotel-Search?adults=2&categorySearch=&children=&daysInFuture&destination=Puerto%20Viejo%20de%20Talamanca%2C%20Cahuita%2C%20Lim%C3%B3n%20Province%2C%20Costa%20Rica&endDate=2026-01-20&semdtl=&sort=RECOMMENDED&startDate=2026-01-15&stayLength&theme=&upsellingDiscountTypeAdded=&upsellingNumNightsAdded=&useRewards=false&userIntent=&paymentType=PAY_LATER&guestRating=40&stay_options_group=hotels_option&regionId=177983&flexibility=1_DAY&latLong&pwaDialog=&latLong%C2%AEionId=177983" target="_blank" rel="noopener noreferrer">Hotels</a></li><li>🏡 <a href="https://www.airbnb.com/s/Puerto-Viejo-de-Talamanca--Limon--Costa-Rica/homes?refinement_paths%5B%5D=%2Fhomes&acp_id=46e3557c-f5fb-46a7-b990-7b9fd0287d9b&date_picker_type=calendar&place_id=ChIJFd-e6wxQpo8RRbmWoq2O61M&location_bb=QRqPYsKle3hBGlWBwqWHrA%3D%3D&checkin=2026-01-15&checkout=2026-01-20&adults=6&source=structured_search_input_header&search_type=autocomplete_click" target="_blank" rel="noopener noreferrer">Airbnb</a></li></ul>             <li><b>🍸 Nightlife</b>: Live music & beach bars; chill clubs.</li>             <li><b>🛡️ Safety</b>: Use taxis at night; rain can make roads slick.</li>             <li><b>🥾 Excursions</b>:</li>                 <ul class="cr-sublist" style="padding-left: 16px; margin: 0;"><li><a href="https://www.google.com/search?q=Cahuita+National+Park+Puerto+Viejo" target="_blank" rel="noopener noreferrer">Cahuita National Park</a></li><li><a href="https://www.google.com/search?q=Jaguar+Rescue+Center+Puerto+Viejo" target="_blank" rel="noopener noreferrer">Jaguar Rescue Center</a></li><li><a href="https://www.google.com/search?q=Punta+Uva+Puerto+Viejo" target="_blank" rel="noopener noreferrer">Punta Uva</a></li><li><a href="https://www.google.com/search?q=Gandoca%E2%80%91Manzanillo+Wildlife+Refuge+Puerto+Viejo" target="_blank" rel="noopener noreferrer">Gandoca‑Manzanillo Wildlife Refuge</a></li><li><a href="https://www.google.com/search?q=Bribri+Chocolate+%2F+Indigenous+Cultural+Tour+Puerto+Viejo" target="_blank" rel="noopener noreferrer">Bribri Chocolate / Indigenous Cultural Tour</a></li><li><a href="https://www.google.com/search?q=Salsa+Brava+Surf+Break+Puerto+Viejo" target="_blank" rel="noopener noreferrer">Salsa Brava Surf Break</a></li></ul>             <br>             <li><b>🧭 Optional Day Trips</b></li>                 <ul class="cr-sublist" style="padding-left: 16px; margin: 0;"><li><a href="https://www.google.com/search?q=Cahuita+Puerto+Viejo" target="_blank" rel="noopener noreferrer">Cahuita</a></li><li><a href="https://www.google.com/search?q=Tortuguero+Puerto+Viejo" target="_blank" rel="noopener noreferrer">Tortuguero</a></li></ul>         </ul>     </div>     </div>`)[0];
            popup_11f54db00fc4d587f66adf58174c9c29.setContent(html_38a6b558815dd03beba017cc83c72485);
        

        marker_bd8bcf8966901722f25a3c28351c816a.bindPopup(popup_11f54db00fc4d587f66adf58174c9c29)
        ;

        
    
    
            var marker_bea859fcd029778c78783c1595c9a5b9 = L.marker(
                [9.6, -86.0],
                {}
            ).addTo(map_c8689fa0fa819fbcc2c9e3f97e0c1fbb);
        
    
            var div_icon_292aeb4269aad7535f3d0095bc503d43 = L.divIcon({"className": "empty", "html": "\u003cdiv style=\"font-size: 24px; letter-spacing: 2px; font-weight: 900; color: rgba(255,255,255,0.98); text-shadow: 0 0 10px rgba(0,0,0,0.7);\"\u003ePACIFIC OCEAN\u003c/div\u003e"});
            marker_bea859fcd029778c78783c1595c9a5b9.setIcon(div_icon_292aeb4269aad7535f3d0095bc503d43);
        
    
            var marker_20a787c1a6f9fa3cdffed9372c7fc16a = L.marker(
                [10.2, -82.2],
                {}
            ).addTo(map_c8689fa0fa819fbcc2c9e3f97e0c1fbb);
        
    
            var div_icon_e57717b15a7fe1b18f0921d15f09d9ec = L.divIcon({"className": "empty", "html": "\u003cdiv style=\"font-size: 24px; letter-spacing: 2px; font-weight: 900; color: rgba(255,255,255,0.98); text-shadow: 0 0 10px rgba(0,0,0,0.7);\"\u003eCARIBBEAN SEA\u003c/div\u003e"});
            marker_20a787c1a6f9fa3cdffed9372c7fc16a.setIcon(div_icon_e57717b15a7fe1b18f0921d15f09d9ec);
        
</script>
</html>